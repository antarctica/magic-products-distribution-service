{
  "$id": "https://metadata-standards.data.bas.ac.uk/bas-magic-products-distribution-configuration-schemas/v1/iso-19115-2-resource-v1.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "BAS MAGIC Products Distribution Service - ISO 19115-2 resource configuration schema v1",
  "description": "Configuration schema (version 1) using the ISO 19115-2 metadata standard for configuring resource permissions within the MAGIC Products Distribution Service",
  "definitions": {
    "constraint": {
      "title": "Constraint",
      "description": "Access/usage constraint describing a limitation on accessing or using the resource",
      "type": "object",
      "required": [
        "type",
        "restriction_code"
      ],
      "additionalProperties": false,
      "properties": {
        "type": {
          "title": "Constraint type",
          "description": "Whether the constraint constrains how the resource can be accessed, or be used.",
          "type": "string",
          "enum": [
            "access",
            "usage"
          ]
        },
        "restriction_code": {
          "title": "Restriction code",
          "description": "The domain the constraint pertains to.",
          "type": "string",
          "enum": [
            "confidential",
            "copyright",
            "inConfidence",
            "intellectualPropertyRights",
            "licenceDistributor",
            "licenceEndUser",
            "licenceUnrestricted",
            "license",
            "otherRestrictions",
            "patent",
            "patentPending",
            "private",
            "restricted",
            "SBU",
            "statutory",
            "trademark",
            "unrestricted"
          ]
        },
        "statement": {
          "title": "Statement",
          "description": "Free-text description/definition of the constraint.",
          "type": "string"
        },
        "href": {
          "title": "URL",
          "description": "URL identifying, or relating to, the constraint.",
          "type": "string",
          "format": "uri"
        },
        "permissions": {
          "$ref": "#/definitions/permissions"
        }
      }
    },
    "constraints": {
      "title": "Constraints",
      "description": "Access/usage constraints for describing limitations on accessing or using the resource.",
      "type": "array",
      "items": {
        "$ref": "#/definitions/constraint"
      }
    },
    "hierarchy_level": {
      "title": "Hierarchy level",
      "description": "The kind and scope of information the resource consists of and describes. Must be a product for this service.",
      "type": "string",
      "enum": [
        "product"
      ],
      "examples": [
        "product"
      ]
    },
    "identification": {
      "title": "Identification",
      "description": "Information about how to reference, categorise, or describe the resource.",
      "type": "object",
      "required": [
        "constraints"
      ],
      "additionalProperties": true,
      "properties": {
        "constraints": {
          "$ref": "#/definitions/constraints"
        }
      }
    },
    "permission": {
      "title": "permission",
      "description": "Conditions which must be met to access artefacts of the resource.",
      "type": "object",
      "required": ["scheme", "scheme_version"],
      "oneOf": [
        {"$ref": "#/definitions/_permissions_ms_graph_v1_alias"},
        {"$ref": "#/definitions/_permissions_ms_graph_v1_object_id"}
      ]
    },
    "_permissions_ms_graph_v1_alias": {
      "additionalProperties": false,
      "properties": {
        "scheme": {
          "$ref": "#/definitions/__permissions_ms_graph_v1_scheme"
        },
        "scheme_version": {
          "$ref": "#/definitions/__permissions_ms_graph_v1_scheme_version"
        },
        "alias": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "_permissions_ms_graph_v1_object_id": {
      "additionalProperties": false,
      "properties": {
        "scheme": {
          "$ref": "#/definitions/__permissions_ms_graph_v1_scheme"
        },
        "scheme_version": {
          "$ref": "#/definitions/__permissions_ms_graph_v1_scheme_version"
        },
        "object_id": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["~nerc"]
          }
        }
      }
    },
    "__permissions_ms_graph_v1_scheme": {
      "title": "Scheme",
      "description": "Permissions scheme, typically provider specific.",
      "type": "string",
      "enum": ["ms_graph"]
    },
    "__permissions_ms_graph_v1_scheme_version": {
      "title": "Scheme version",
      "description": "Permissions scheme version.",
      "type": "string",
      "enum": ["1"]
    },
    "permissions": {
      "title": "Permissions",
      "description": "A series of conditions that must all be met to access artefacts of the resource.",
      "oneOf": [
        {
          "type": "string"
        },
        {
          "type": "array",
          "items": {
            "$ref": "#/definitions/permission"
          }
        }
      ]
    },
    "resource": {
      "title": "Resource",
      "description": "Description of the resource to be processed by this service, including its artefacts and the permissions that should apply to them.",
      "type": "object",
      "required": [
        "file_identifier",
        "hierarchy_level",
        "identification",
        "distribution"
      ],
      "additionalItems": true,
      "properties": {
        "hierarchy_level": {
          "$ref": "#/definitions/hierarchy_level"
        },
        "identification": {
          "$ref": "#/definitions/identification"
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "https://metadata-standards.data.bas.ac.uk/bas-metadata-generator-configuration-schemas/v2/iso-19115-1-v2.json"
    },
    {
      "$ref": "#/definitions/resource"
    }
  ]
}
